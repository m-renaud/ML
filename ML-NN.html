<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>ML.NN</title><link href="ocean.css" rel="stylesheet" type="text/css" title="Ocean" /><script src="haddock-util.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
window.onload = function () {pageLoad();setSynopsis("mini_ML-NN.html");};
//]]>
</script></head><body><div id="package-header"><ul class="links" id="page-menu"><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul><p class="caption">ML-0.1.0.0: Machine learning code.</p></div><div id="content"><div id="module-header"><table class="info"><tr><th>Safe Haskell</th><td>None</td></tr><tr><th>Language</th><td>Haskell2010</td></tr></table><p class="caption">ML.NN</p></div><div id="table-of-contents"><p class="caption">Contents</p><ul><li><a href="#g:1">Data types</a></li><li><a href="#g:2">Network initialization</a></li><li><a href="#g:3">Running networks</a></li><li><a href="#g:4">Training networks</a></li><li><a href="#g:5">Cost function derivatives</a></li></ul></div><div id="description"><p class="caption">Description</p><div class="doc"><p>Simple neural network implementation, for learning purposes only.</p></div></div><div id="synopsis"><p id="control.syn" class="caption expander" onclick="toggleSection('syn')">Synopsis</p><ul id="section.syn" class="hide" onclick="toggleSection('syn')"><li class="src short"><span class="keyword">type</span> <a href="#t:ActivationFunction">ActivationFunction</a> = <a href="../hmatrix-0.17.0.1/Numeric-LinearAlgebra-Data.html#t:R">R</a> -&gt; <a href="../hmatrix-0.17.0.1/Numeric-LinearAlgebra-Data.html#t:R">R</a></li><li class="src short"><span class="keyword">type</span> <a href="#t:ActivationFunctionDerivative">ActivationFunctionDerivative</a> = <a href="../hmatrix-0.17.0.1/Numeric-LinearAlgebra-Data.html#t:R">R</a> -&gt; <a href="../hmatrix-0.17.0.1/Numeric-LinearAlgebra-Data.html#t:R">R</a></li><li class="src short"><span class="keyword">data</span> <a href="#t:Layer">Layer</a> = <a href="#v:Layer">Layer</a> {<ul class="subs"><li><a href="#v:layerBiases">layerBiases</a> :: <a href="../hmatrix-0.17.0.1/Numeric-LinearAlgebra-Data.html#t:Vector">Vector</a> <a href="../hmatrix-0.17.0.1/Numeric-LinearAlgebra-Data.html#t:R">R</a></li><li><a href="#v:layerWeights">layerWeights</a> :: <a href="../hmatrix-0.17.0.1/Numeric-LinearAlgebra-Data.html#t:Matrix">Matrix</a> <a href="../hmatrix-0.17.0.1/Numeric-LinearAlgebra-Data.html#t:R">R</a></li></ul>}</li><li class="src short"><span class="keyword">data</span> <a href="#t:Network">Network</a> = <a href="#v:Network">Network</a> {<ul class="subs"><li><a href="#v:networkLayers">networkLayers</a> :: [<a href="ML-NN.html#t:Layer">Layer</a>]</li></ul>}</li><li class="src short"><a href="#v:randLayer">randLayer</a> :: <a href="../random-1.1/System-Random.html#t:RandomGen">RandomGen</a> g =&gt; <a href="../base-4.8.2.0/Data-Int.html#t:Int">Int</a> -&gt; <a href="../base-4.8.2.0/Data-Int.html#t:Int">Int</a> -&gt; <a href="../MonadRandom-0.4.2.3/Control-Monad-Random.html#t:Rand">Rand</a> g <a href="ML-NN.html#t:Layer">Layer</a></li><li class="src short"><a href="#v:randNetwork">randNetwork</a> :: <a href="../random-1.1/System-Random.html#t:RandomGen">RandomGen</a> g =&gt; [<a href="../base-4.8.2.0/Data-Int.html#t:Int">Int</a>] -&gt; <a href="../MonadRandom-0.4.2.3/Control-Monad-Random.html#t:Rand">Rand</a> g <a href="ML-NN.html#t:Network">Network</a></li><li class="src short"><a href="#v:feedForward">feedForward</a> :: <a href="ML-NN.html#t:ActivationFunction">ActivationFunction</a> -&gt; <a href="../hmatrix-0.17.0.1/Numeric-LinearAlgebra-Data.html#t:Vector">Vector</a> <a href="../hmatrix-0.17.0.1/Numeric-LinearAlgebra-Data.html#t:R">R</a> -&gt; <a href="ML-NN.html#t:Layer">Layer</a> -&gt; <a href="../hmatrix-0.17.0.1/Numeric-LinearAlgebra-Data.html#t:Vector">Vector</a> <a href="../hmatrix-0.17.0.1/Numeric-LinearAlgebra-Data.html#t:R">R</a></li><li class="src short"><a href="#v:runNetwork">runNetwork</a> :: <a href="ML-NN.html#t:Network">Network</a> -&gt; <a href="ML-NN.html#t:ActivationFunction">ActivationFunction</a> -&gt; <a href="../hmatrix-0.17.0.1/Numeric-LinearAlgebra-Data.html#t:Vector">Vector</a> <a href="../hmatrix-0.17.0.1/Numeric-LinearAlgebra-Data.html#t:R">R</a> -&gt; <a href="../hmatrix-0.17.0.1/Numeric-LinearAlgebra-Data.html#t:Vector">Vector</a> <a href="../hmatrix-0.17.0.1/Numeric-LinearAlgebra-Data.html#t:R">R</a></li><li class="src short"><span class="keyword">data</span> <a href="#t:TrainingConfig">TrainingConfig</a> = <a href="#v:TrainingConfig">TrainingConfig</a> {<ul class="subs"><li><a href="#v:trainingEpochs">trainingEpochs</a> :: <a href="../base-4.8.2.0/Data-Int.html#t:Int">Int</a></li><li><a href="#v:trainingEta">trainingEta</a> :: <a href="../hmatrix-0.17.0.1/Numeric-LinearAlgebra-Data.html#t:R">R</a></li><li><a href="#v:trainingActivation">trainingActivation</a> :: <a href="ML-NN.html#t:ActivationFunction">ActivationFunction</a></li><li><a href="#v:trainingActivationDerivative">trainingActivationDerivative</a> :: <a href="ML-NN.html#t:ActivationFunctionDerivative">ActivationFunctionDerivative</a></li><li><a href="#v:trainingCostDerivative">trainingCostDerivative</a> :: <a href="ML-NN.html#t:CostDerivative">CostDerivative</a></li></ul>}</li><li class="src short"><span class="keyword">data</span> <a href="#t:Sample">Sample</a> = <a href="#v:Sample">Sample</a> {<ul class="subs"><li><a href="#v:sampleInput">sampleInput</a> :: <a href="../hmatrix-0.17.0.1/Numeric-LinearAlgebra-Data.html#t:Vector">Vector</a> <a href="../hmatrix-0.17.0.1/Numeric-LinearAlgebra-Data.html#t:R">R</a></li><li><a href="#v:sampleExpectedOutput">sampleExpectedOutput</a> :: <a href="../hmatrix-0.17.0.1/Numeric-LinearAlgebra-Data.html#t:Vector">Vector</a> <a href="../hmatrix-0.17.0.1/Numeric-LinearAlgebra-Data.html#t:R">R</a></li></ul>}</li><li class="src short"><span class="keyword">type</span> <a href="#t:CostDerivative">CostDerivative</a> = <a href="../hmatrix-0.17.0.1/Numeric-LinearAlgebra-Data.html#t:Vector">Vector</a> <a href="../hmatrix-0.17.0.1/Numeric-LinearAlgebra-Data.html#t:R">R</a> -&gt; <a href="../hmatrix-0.17.0.1/Numeric-LinearAlgebra-Data.html#t:Vector">Vector</a> <a href="../hmatrix-0.17.0.1/Numeric-LinearAlgebra-Data.html#t:R">R</a> -&gt; <a href="../hmatrix-0.17.0.1/Numeric-LinearAlgebra-Data.html#t:Vector">Vector</a> <a href="../hmatrix-0.17.0.1/Numeric-LinearAlgebra-Data.html#t:R">R</a></li><li class="src short"><a href="#v:gradientDescent">gradientDescent</a> :: <a href="ML-NN.html#t:TrainingConfig">TrainingConfig</a> -&gt; [<a href="ML-NN.html#t:Sample">Sample</a>] -&gt; <a href="ML-NN.html#t:Network">Network</a> -&gt; <a href="ML-NN.html#t:Network">Network</a></li><li class="src short"><a href="#v:mse-39-">mse'</a> :: <a href="ML-NN.html#t:CostDerivative">CostDerivative</a></li></ul></div><div id="interface"><h1 id="g:1">Data types</h1><div class="top"><p class="src"><span class="keyword">type</span> <a name="t:ActivationFunction" class="def">ActivationFunction</a> = <a href="../hmatrix-0.17.0.1/Numeric-LinearAlgebra-Data.html#t:R">R</a> -&gt; <a href="../hmatrix-0.17.0.1/Numeric-LinearAlgebra-Data.html#t:R">R</a></p><div class="doc"><p>An activation function for a neuron.</p></div></div><div class="top"><p class="src"><span class="keyword">type</span> <a name="t:ActivationFunctionDerivative" class="def">ActivationFunctionDerivative</a> = <a href="../hmatrix-0.17.0.1/Numeric-LinearAlgebra-Data.html#t:R">R</a> -&gt; <a href="../hmatrix-0.17.0.1/Numeric-LinearAlgebra-Data.html#t:R">R</a></p><div class="doc"><p>The derivative of a neuron activation function.</p></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a name="t:Layer" class="def">Layer</a></p><div class="doc"><p>A layer in a neural network is a bias vector and weight matrix.</p><p>Let <em>n</em> be the number of neurons in the layer and <em>m</em> be the number
 of inputs to the layer. Then <code><a href="ML-NN.html#v:layerBiases">layerBiases</a></code> is a vector in R&#8319; and
 <code><a href="ML-NN.html#v:layerWeights">layerWeights</a></code> is an <em>nxm</em> real matrix.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a name="v:Layer" class="def">Layer</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><dl><dt class="src"><a name="v:layerBiases" class="def">layerBiases</a> :: <a href="../hmatrix-0.17.0.1/Numeric-LinearAlgebra-Data.html#t:Vector">Vector</a> <a href="../hmatrix-0.17.0.1/Numeric-LinearAlgebra-Data.html#t:R">R</a></dt><dd class="doc"><p>A vector in R&#8319; representing the neuron biases.</p></dd><dt class="src"><a name="v:layerWeights" class="def">layerWeights</a> :: <a href="../hmatrix-0.17.0.1/Numeric-LinearAlgebra-Data.html#t:Matrix">Matrix</a> <a href="../hmatrix-0.17.0.1/Numeric-LinearAlgebra-Data.html#t:R">R</a></dt><dd class="doc"><p>An <em>nxm</em> real matrix of the neuron weights.</p></dd></dl><div class="clear"></div></div></td></tr></table></div><div class="subs instances"><p id="control.i:Layer" class="caption collapser" onclick="toggleSection('i:Layer')">Instances</p><div id="section.i:Layer" class="show"><table><tr><td class="src clearfix"><span class="inst-left"><a href="../base-4.8.2.0/Text-Read.html#t:Read">Read</a> <a href="ML-NN.html#t:Layer">Layer</a></span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="../base-4.8.2.0/Text-Show.html#t:Show">Show</a> <a href="ML-NN.html#t:Layer">Layer</a></span></td><td class="doc empty">&nbsp;</td></tr></table></div></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a name="t:Network" class="def">Network</a></p><div class="doc"><p>A network is a list of layers.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a name="v:Network" class="def">Network</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><dl><dt class="src"><a name="v:networkLayers" class="def">networkLayers</a> :: [<a href="ML-NN.html#t:Layer">Layer</a>]</dt><dd class="doc"><p>Layers in the neural network.</p></dd></dl><div class="clear"></div></div></td></tr></table></div><div class="subs instances"><p id="control.i:Network" class="caption collapser" onclick="toggleSection('i:Network')">Instances</p><div id="section.i:Network" class="show"><table><tr><td class="src clearfix"><span class="inst-left"><a href="../base-4.8.2.0/Text-Read.html#t:Read">Read</a> <a href="ML-NN.html#t:Network">Network</a></span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="../base-4.8.2.0/Text-Show.html#t:Show">Show</a> <a href="ML-NN.html#t:Network">Network</a></span></td><td class="doc empty">&nbsp;</td></tr></table></div></div></div><h1 id="g:2">Network initialization</h1><div class="top"><p class="src"><a name="v:randLayer" class="def">randLayer</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="../random-1.1/System-Random.html#t:RandomGen">RandomGen</a> g</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">=&gt; <a href="../base-4.8.2.0/Data-Int.html#t:Int">Int</a></td><td class="doc"><p>Number of inputs into the layer.</p></td></tr><tr><td class="src">-&gt; <a href="../base-4.8.2.0/Data-Int.html#t:Int">Int</a></td><td class="doc"><p>Number of neurons in the layer.</p></td></tr><tr><td class="src">-&gt; <a href="../MonadRandom-0.4.2.3/Control-Monad-Random.html#t:Rand">Rand</a> g <a href="ML-NN.html#t:Layer">Layer</a></td><td class="doc"><p>Randomly generated layer.</p></td></tr></table></div><div class="doc"><p>Generate a randomly initialized layer in a neural network.</p></div></div><div class="top"><p class="src"><a name="v:randNetwork" class="def">randNetwork</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="../random-1.1/System-Random.html#t:RandomGen">RandomGen</a> g</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">=&gt; [<a href="../base-4.8.2.0/Data-Int.html#t:Int">Int</a>]</td><td class="doc"><p>Number of neurons in each layer.</p></td></tr><tr><td class="src">-&gt; <a href="../MonadRandom-0.4.2.3/Control-Monad-Random.html#t:Rand">Rand</a> g <a href="ML-NN.html#t:Network">Network</a></td><td class="doc"><p>Randomly generated network.</p></td></tr></table></div><div class="doc"><p>Generate a random neural network given the sizes of each of the layers.</p><p>For example, <code>[3,2,4]</code> will generate a neural network with 3 input
 neurons, 1 hidden layer with 2 neurons and 4 output neurons.</p></div></div><h1 id="g:3">Running networks</h1><div class="top"><p class="src"><a name="v:feedForward" class="def">feedForward</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="ML-NN.html#t:ActivationFunction">ActivationFunction</a></td><td class="doc"><p>Neuron activation function.</p></td></tr><tr><td class="src">-&gt; <a href="../hmatrix-0.17.0.1/Numeric-LinearAlgebra-Data.html#t:Vector">Vector</a> <a href="../hmatrix-0.17.0.1/Numeric-LinearAlgebra-Data.html#t:R">R</a></td><td class="doc"><p>Input to the layer.</p></td></tr><tr><td class="src">-&gt; <a href="ML-NN.html#t:Layer">Layer</a></td><td class="doc"><p>Layer to run.</p></td></tr><tr><td class="src">-&gt; <a href="../hmatrix-0.17.0.1/Numeric-LinearAlgebra-Data.html#t:Vector">Vector</a> <a href="../hmatrix-0.17.0.1/Numeric-LinearAlgebra-Data.html#t:R">R</a></td><td class="doc"><p>Output from the layer.</p></td></tr></table></div><div class="doc"><p>Feed the output from a previous layer to the next layer.</p></div></div><div class="top"><p class="src"><a name="v:runNetwork" class="def">runNetwork</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="ML-NN.html#t:Network">Network</a></td><td class="doc"><p>Network to run.</p></td></tr><tr><td class="src">-&gt; <a href="ML-NN.html#t:ActivationFunction">ActivationFunction</a></td><td class="doc"><p>Neuron activation function.</p></td></tr><tr><td class="src">-&gt; <a href="../hmatrix-0.17.0.1/Numeric-LinearAlgebra-Data.html#t:Vector">Vector</a> <a href="../hmatrix-0.17.0.1/Numeric-LinearAlgebra-Data.html#t:R">R</a></td><td class="doc"><p>Network input.</p></td></tr><tr><td class="src">-&gt; <a href="../hmatrix-0.17.0.1/Numeric-LinearAlgebra-Data.html#t:Vector">Vector</a> <a href="../hmatrix-0.17.0.1/Numeric-LinearAlgebra-Data.html#t:R">R</a></td><td class="doc"><p>Network output.</p></td></tr></table></div><div class="doc"><p>Run a neural network.</p></div></div><h1 id="g:4">Training networks</h1><div class="top"><p class="src"><span class="keyword">data</span> <a name="t:TrainingConfig" class="def">TrainingConfig</a></p><div class="doc"><p>Configuration for training a network.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a name="v:TrainingConfig" class="def">TrainingConfig</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><dl><dt class="src"><a name="v:trainingEpochs" class="def">trainingEpochs</a> :: <a href="../base-4.8.2.0/Data-Int.html#t:Int">Int</a></dt><dd class="doc"><p>Number of epochs of training to perform.</p></dd><dt class="src"><a name="v:trainingEta" class="def">trainingEta</a> :: <a href="../hmatrix-0.17.0.1/Numeric-LinearAlgebra-Data.html#t:R">R</a></dt><dd class="doc"><p>&#951; - Learning rate.</p></dd><dt class="src"><a name="v:trainingActivation" class="def">trainingActivation</a> :: <a href="ML-NN.html#t:ActivationFunction">ActivationFunction</a></dt><dd class="doc empty">&nbsp;</dd><dt class="src"><a name="v:trainingActivationDerivative" class="def">trainingActivationDerivative</a> :: <a href="ML-NN.html#t:ActivationFunctionDerivative">ActivationFunctionDerivative</a></dt><dd class="doc empty">&nbsp;</dd><dt class="src"><a name="v:trainingCostDerivative" class="def">trainingCostDerivative</a> :: <a href="ML-NN.html#t:CostDerivative">CostDerivative</a></dt><dd class="doc empty">&nbsp;</dd></dl><div class="clear"></div></div></td></tr></table></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a name="t:Sample" class="def">Sample</a></p><div class="doc"><p>A training sample.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a name="v:Sample" class="def">Sample</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><dl><dt class="src"><a name="v:sampleInput" class="def">sampleInput</a> :: <a href="../hmatrix-0.17.0.1/Numeric-LinearAlgebra-Data.html#t:Vector">Vector</a> <a href="../hmatrix-0.17.0.1/Numeric-LinearAlgebra-Data.html#t:R">R</a></dt><dd class="doc empty">&nbsp;</dd><dt class="src"><a name="v:sampleExpectedOutput" class="def">sampleExpectedOutput</a> :: <a href="../hmatrix-0.17.0.1/Numeric-LinearAlgebra-Data.html#t:Vector">Vector</a> <a href="../hmatrix-0.17.0.1/Numeric-LinearAlgebra-Data.html#t:R">R</a></dt><dd class="doc empty">&nbsp;</dd></dl><div class="clear"></div></div></td></tr></table></div><div class="subs instances"><p id="control.i:Sample" class="caption collapser" onclick="toggleSection('i:Sample')">Instances</p><div id="section.i:Sample" class="show"><table><tr><td class="src clearfix"><span class="inst-left"><a href="../base-4.8.2.0/Text-Read.html#t:Read">Read</a> <a href="ML-NN.html#t:Sample">Sample</a></span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="../base-4.8.2.0/Text-Show.html#t:Show">Show</a> <a href="ML-NN.html#t:Sample">Sample</a></span></td><td class="doc empty">&nbsp;</td></tr></table></div></div></div><div class="top"><p class="src"><span class="keyword">type</span> <a name="t:CostDerivative" class="def">CostDerivative</a> = <a href="../hmatrix-0.17.0.1/Numeric-LinearAlgebra-Data.html#t:Vector">Vector</a> <a href="../hmatrix-0.17.0.1/Numeric-LinearAlgebra-Data.html#t:R">R</a> -&gt; <a href="../hmatrix-0.17.0.1/Numeric-LinearAlgebra-Data.html#t:Vector">Vector</a> <a href="../hmatrix-0.17.0.1/Numeric-LinearAlgebra-Data.html#t:R">R</a> -&gt; <a href="../hmatrix-0.17.0.1/Numeric-LinearAlgebra-Data.html#t:Vector">Vector</a> <a href="../hmatrix-0.17.0.1/Numeric-LinearAlgebra-Data.html#t:R">R</a></p><div class="doc"><p>A vectorized function which returns &#8706;C&#8339;/&#8706;a.</p><p>The first parameter is the output activation, the second parameter is the
 expected output.</p></div></div><div class="top"><p class="src"><a name="v:gradientDescent" class="def">gradientDescent</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="ML-NN.html#t:TrainingConfig">TrainingConfig</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">-&gt; [<a href="ML-NN.html#t:Sample">Sample</a>]</td><td class="doc"><p>Training data (input, expected output).</p></td></tr><tr><td class="src">-&gt; <a href="ML-NN.html#t:Network">Network</a></td><td class="doc"><p>Current network.</p></td></tr><tr><td class="src">-&gt; <a href="ML-NN.html#t:Network">Network</a></td><td class="doc"><p>Updated network.</p></td></tr></table></div><div class="doc"><p>Train the neural network using gradient descent.</p></div></div><h1 id="g:5">Cost function derivatives</h1><div class="top"><p class="src"><a name="v:mse-39-" class="def">mse'</a> :: <a href="ML-NN.html#t:CostDerivative">CostDerivative</a></p><div class="doc"><p>The derivative of the mean squared error cost function.</p></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.16.1</p></div></body></html>